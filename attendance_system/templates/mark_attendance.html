{% extends "base.html" %}

{% block title %}Mark Attendance - {{ course.class_name }}{% endblock %}

{% block content %}
<div class="flex-between mb-6">
    <div>
        <a href="{{ url_for('teacher.dashboard') }}"
            style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 0.5rem; display: inline-block;">
            <i class="fas fa-arrow-left"></i> Back to Dashboard
        </a>
        <h2>{{ course.class_name }}</h2>
        <p style="color: var(--text-muted);">Marking attendance for today</p>
    </div>
    <div class="card" style="padding: 0.5rem 1rem;">
        <span style="color: var(--text-muted); font-size: 0.9rem;">Date:</span>
        <strong style="margin-left: 0.5rem;">{{ today }}</strong>
    </div>
</div>

<form method="POST">
    <div class="card">
        <!-- Date Selection Override -->
        <div class="flex-between mb-6" style="border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 1.5rem;">
            <div style="display: flex; gap: 1rem; align-items: center;">
                <label style="margin: 0;">Attendance Date:</label>
                <input type="date" name="date" value="{{ today }}" required style="width: auto;">
            </div>
            <div style="color: var(--text-muted); font-size: 0.9rem;">
                Total Students: <strong style="color: var(--text-main);">{{ students|length }}</strong>
            </div>
        </div>

        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th style="width: 40px;">#</th>
                        <th>Student Name</th>
                        <th>Email</th>
                        <th style="width: 250px;">Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td style="color: var(--text-muted);">{{ loop.index }}</td>
                        <td>
                            <div style="font-weight: 500;">{{ student.name }}</div>
                        </td>
                        <td style="color: var(--text-muted);">{{ student.email }}</td>
                        <td>
                            <div class="attendance-options">
                                <label style="flex: 1;">
                                    <input type="radio" name="status_{{ student.id }}" value="Present" checked>
                                    <div class="attendance-btn">Present</div>
                                </label>
                                <label style="flex: 1;">
                                    <input type="radio" name="status_{{ student.id }}" value="Absent">
                                    <div class="attendance-btn">Absent</div>
                                </label>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div
            style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: flex-end;">
            <button type="button" onclick="history.back()" class="btn btn-danger"
                style="background: transparent; border: 1px solid #dc2626; color: #dc2626; margin-right: 1rem;">Cancel</button>
            <button type="submit" class="btn btn-primary" onclick="showToast('Saving attendance...', 'success')">
                <i class="fas fa-save"></i> Save Attendance
            </button>
        </div>
    </div>
</form>
{% endblock %}